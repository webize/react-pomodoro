<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="icon" href="img/favicon.png" sizes="32x32">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,900' rel='stylesheet' type='text/css'>

    <!-- SEO -->
		<meta name="description" content="Pomodoro timer for developers.">
    <title>Pomodoro timer</title>

    <!-- Open graph -->
		<meta property="og:type" content="website">
		<meta property="og:title" content="Pomodoro timer">
		<meta property="og:description" content="Pomodoro timer for developers.">
		<meta property="og:url" content="http://afonsopacifer.github.io/react-pomodoro/">
		<meta property="og:image" content="http://afonsopacifer.github.io/react-pomodoro/img/share.png">

		<!-- Twitter cards -->
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:title" content="Pomodoro timer">
		<meta name="twitter:description" content="Pomodoro timer for developers.">
		<meta name="twitter:url" content="http://afonsopacifer.github.io/react-pomodoro/">
		<meta name="twitter:image" content="http://afonsopacifer.github.io/react-pomodoro/img/share.png">

		<!-- CSS <3 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.css">
    <link rel="stylesheet" href="css/style.css">


  </head>
  <body>
    <div id="app"></div>
    <script type="text/JavaScript" src="bundle.js"></script>
    <script src="https://solid.github.io/releases/rdflib.js/rdflib-0.6.0.min.js"></script>
    <script src="https://solid.github.io/releases/solid.js/solid-0.14.1.min.js"></script>
    <script src="js/notie.js"></script>
    <script>
      // TODO : move to webize.js
      // $rdf is exported as a global when you load RDFLib, above
      var solid = require('solid')
      // Use Solid client here ...
      console.log('solid.js version: ' + solid.meta.version())

      document.addEventListener('keydown', function(e){
        if(e.keyCode == 76 && (e.ctrlKey || e.metaKey)){

          var storage;
          authEndpoint = 'https://databox.me/';
          var dologin = function() {
            // Get the current user
            solid.auth.login(authEndpoint).then(function(webid){
              // authentication succeeded; do something with the WebID string
              notie.alert(1, 'Success!  You are logged in as : ' + webid);

              solid.identity.getProfile(webid).then(function (parsedProfile) {
                console.log('getProfile result: %o', parsedProfile)
                console.log('Account storage root: %s', parsedProfile.storage) // array of URIs })
                storage = parsedProfile.storage[0];
                console.log(storage);
                var containerName = 'localStorage';

                var url = storage + containerName;
                solid.web.get(url).then(
                  function(response) {
                    console.log('Raw resource: %s', response.raw())
                  }
                ).catch(
                  function(err) {
                    console.log(err) // error object
                    // ...
                    var parentDir = 'https://example.org/'
                    var slug = 'localStorage'
                    var data = '<#this> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> <http://rdfs.org/sioc/ns#Space> .'
                    var isContainer = true

                    solid.web.post(storage, data, slug, true).then(
                      function(solidResponse) {
                        console.log(solidResponse)
                        // The resulting object has several useful properties.
                        // See lib/solid-response.js for details
                        // solidResponse.url - value of the Location header
                        // solidResponse.acl - url of acl resource
                        // solidResponse.meta - url of meta resource
                      }
                    ).catch(function(err){
                      console.log(err) // error object
                      console.log(err.status) // contains the error status
                      console.log(err.xhr) // contains the xhr object
                    })

                  }
                )


              });

              window.user = webid;
            }).catch(function(err) {
              // authentication failed; display some error message
              alert(err);
            });
          };


          dologin();
          return false;
        }
      });

    </script>
  </body>
</html>
